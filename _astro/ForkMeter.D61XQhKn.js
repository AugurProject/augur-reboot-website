import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r as o}from"./index.BVOCwoKb.js";import{$ as b,U as A}from"./animationStore.DYtN9AJJ.js";const O={STABLE:{minValue:0,maxValue:10,primaryText:"ALL MARKETS ARE STABLE",secondaryContent:"timestamp"},WARNING:{minValue:11,maxValue:60,primaryText:"MARKET VOLATILITY DETECTED",secondaryContent:"metadata"},FORK_IMMINENT:{minValue:61,maxValue:80,primaryText:"FORK CONDITIONS BUILDING",secondaryContent:"metadata"},CRITICAL:{minValue:81,maxValue:100,primaryText:"FORK IMMINENT - CRITICAL",secondaryContent:"custom",customContent:"EMERGENCY PROTOCOL ACTIVE"}},D=({metadata:d,stateMap:c=O,customStateContent:S={}})=>{const{value:n,last_updated:l,animated:s=!0,...r}=d,[m,x]=o.useState(s?0:n),[g,f]=o.useState(!1),E=o.useRef(null);o.useEffect(()=>{if(!s){x(n);return}const a=document.getElementById("hero-banner-container");if(!a)return;const t=a.classList.contains("animations-skipped"),u=a.classList.contains("animations-started");if(t)f(!0);else if(u){const i=setTimeout(()=>{f(!0)},8600);return()=>clearTimeout(i)}},[s]),o.useEffect(()=>{if(!s){x(n);return}if(!g)return;const a=Math.max(0,Math.min(100,n)),t=m,u=1500,p=Date.now(),i=()=>{const C=Date.now()-p,T=Math.min(C/u,1),L=1-Math.pow(1-T,3),R=t+(a-t)*L;x(R),T<1&&requestAnimationFrame(i)};i()},[n,s,g]);const y=((a,t)=>Object.entries(t).find(([p,i])=>a>=i.minValue&&a<=i.maxValue)?.[0]||"FORK_IMMINENT")(n,c),h=c[y],k=n>60,M="prediction"in r&&"round"in r&&"staked"in r&&"remaining_time"in r;k&&!M&&console.error("ForkMeter: prediction, round, staked, and remaining_time are required when value > 60");const j=a=>{const t=new Date(a),u=t.getUTCFullYear(),p=String(t.getUTCMonth()+1).padStart(2,"0"),i=String(t.getUTCDate()).padStart(2,"0"),C=String(t.getUTCHours()).padStart(2,"0"),T=String(t.getUTCMinutes()).padStart(2,"0");return`${u}-${p}-${i} ${C}:${T} GMT`},N=Math.PI*80,V=N,v=N-m/100*N,w=m/100*180;return e.jsxs("div",{ref:E,className:"mx-auto max-w-lg p-6",children:[e.jsx("div",{className:"relative mb-2",children:e.jsxs("svg",{viewBox:"0 0 200 120",className:"w-[160px] mx-auto overflow-visible",children:[e.jsx("path",{d:"M 20 100 A 80 80 0 0 1 180 100",fill:"none",stroke:"var(--color-green-500)",strokeWidth:"10",strokeLinecap:"round",opacity:"0.3"}),e.jsx("path",{d:"M 20 100 A 80 80 0 0 1 180 100",fill:"none",stroke:"var(--color-green-500)",strokeWidth:"10",strokeLinecap:"round",strokeDasharray:V,strokeDashoffset:v,style:{filter:"drop-shadow(0 0 6px var(--color-green-500))",transition:s?"stroke-dashoffset 1.5s cubic-bezier(0.25, 0.46, 0.45, 0.94)":"none"}}),e.jsx("line",{x1:"100",y1:"100",x2:"100",y2:"28",stroke:"var(--color-green-500)",strokeWidth:"2",strokeLinecap:"round",style:{transformOrigin:"100px 100px",transform:`rotate(${w-90}deg)`,filter:"drop-shadow(0 0 4px var(--color-green-500))",transition:s?"transform 1.5s cubic-bezier(0.25, 0.46, 0.45, 0.94)":"none"}}),e.jsx("circle",{cx:"100",cy:"100",r:"4",fill:"var(--color-green-500)",style:{filter:"drop-shadow(0 0 4px var(--color-green-500))"}})]})}),e.jsx("p",{className:"text-loud-foreground font-bold text-center break-words mb-1 uppercase tracking-wider",children:h.primaryText}),h.secondaryContent==="metadata"&&M&&e.jsxs("div",{className:"flex justify-center items-center mb-2",children:[e.jsx("div",{className:"font-bold px-4 border-r border-green-500/20",children:r.round}),e.jsx("div",{className:"font-bold px-4",children:r.remaining_time}),e.jsx("div",{className:"font-bold px-4 border-l border-green-500/20",children:r.staked})]}),h.secondaryContent==="custom"&&e.jsx("div",{className:"text-center mb-2",children:e.jsx("div",{className:"text-sm text-loud-foreground uppercase tracking-wider",children:S[y]||h.customContent||"CUSTOM STATE ACTIVE"})}),e.jsx("div",{className:"text-center",children:e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"LAST UPDATED:"})," ",e.jsx("span",{className:"text-foreground",children:j(l)})]})})]})},$=({value:d=75,animated:c=!0})=>{const[S,n]=o.useState(!1),[l,s]=o.useState(c);o.useEffect(()=>{const x=b.subscribe(E=>{const I=E.uiState===A.MAIN_CONTENT;n(I),s(c)}),f=b.get().uiState===A.MAIN_CONTENT;return n(f),s(c),x},[c]);const r=o.useMemo(()=>new Date().toISOString(),[]),m=o.useMemo(()=>d>60?{value:d,animated:l,last_updated:r,prediction:"ETH WILL BE ABOVE $4,000 BY JULY, 2026",round:"RD 2",remaining_time:"120 HRS",staked:"REP 4,000,000"}:{value:d,animated:l,last_updated:r},[d,l,r]);return S?e.jsx(D,{metadata:m}):null};export{$ as default};
