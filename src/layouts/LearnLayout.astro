---
import Layout from "../layouts/Layout.astro";
import SocialLinks from "../components/SocialLinks.astro";
import Footer from "../components/Footer.astro";
import LearnNavigation from "../components/LearnNavigation.tsx";
import Button from "../components/Button.tsx";
import Pointer from "../components/Pointer.tsx";
import PageHeading from "../components/PageHeading.astro";
import { withBase } from "../lib/utils";

interface Props {
	title: string
	description?: string
}

const { title, description } = Astro.props

// Topic navigation data
const topics = [
	{ title: 'WHAT IS A FORK?', slug: '/learn/fork', path: '/learn/fork' },
	{
		title: 'HOW DISPUTES & BONDS WORK',
		slug: '/learn/fork/disputes-and-bonds',
		path: '/learn/fork/disputes-and-bonds',
	},
	{ title: 'WHAT TO DO', slug: '/learn/fork/what-to-do', path: '/learn/fork/what-to-do' },
]

const currentPath = Astro.url.pathname
---

<Layout
	title={`${title} - Augur Fork Mechanics`}
	description={description || "Learn about Augur protocol forks and fork mechanics"}
	ogType="article"
>
	<div class="grid grid-rows-[auto_1fr_auto] min-h-screen">
		{/* Top Section: Navigation */}
		<div class="flex justify-between items-start p-8">
			{/* Back Button */}
			<Button id="back-button" variant="link" href={withBase('/?intro=false')} autofocus>
				<Pointer direction="left" animated="auto" />
				BACK TO HOME
			</Button>

			{/* Social Links */}
			<SocialLinks />
		</div>

		{/* Middle Section: Scrollable Content */}
		<main class="overflow-y-auto px-4 md:px-8 mb-12">
			<div class="max-w-xl mx-auto">
				<PageHeading text={title} />

				{/* Main Content */}
				<article class="prose prose-sm prose-invert max-w-none">
					<slot />
				</article>
			</div>
		</main>

		{/* Bottom Section: Sticky Navigation + Footer */}
		<LearnNavigation client:load currentPath={currentPath} currentTitle={title} topics={topics} />
		<Footer />
	</div>

	<style is:global>
		/* Custom prose styles for dark mode - Tailwind v4 CSS-first approach */
		.prose {
			--tw-prose-headings: var(--color-loud-foreground);
			--tw-prose-links: var(--color-primary);
			--tw-prose-body: var(--color-foreground);
			--tw-prose-bold: var(--color-foreground);
			--tw-prose-code: var(--color-green-400);
			--tw-prose-borders: var(--color-primary);
			--tw-prose-bg-hover: var(--color-primary);
			--tw-prose-line-height: 1.2;
			--tw-prose-pre-bg: transparent;
			--tw-prose-pre-code: var(--color-foreground);
		}

		.prose-sm {
			line-height: 1.325em;
			letter-spacing: 0.025em;
		}

		.prose :is(h1, h2, h3, h4, h5, h6) {
			text-transform: uppercase;
		}

		.prose h1 {
			font-size: 1.5rem;
		}

		.prose p {
			font-family: var(--tw-prose-p-font-family);
		}

		.prose li {
			font-family: var(--tw-prose-p-font-family);
		}

		.prose ol > li::marker {
			color: var(--color-muted-foreground);
		}

		.prose table td {
			font-family: var(--tw-prose-p-font-family);
		}

		/* Override Shiki syntax highlighting theme for code blocks */
		.prose pre.astro-code {
			background-color: transparent !important;
			border: none;
			padding: 0;
		}

		.prose pre.astro-code code {
			color: var(--color-foreground);
		}

		/* Blockquote styling */
		.prose blockquote {
			border-left-color: var(--color-muted-foreground);
		}

		.prose blockquote p {
			color: var(--color-foreground);
		}
	</style>
</Layout>
