---
import type { AstroComponentFactory } from 'astro'
import '../styles/global.css'

interface Props {
	title: string
	description?: string
}

const { title, description } = Astro.props

// Topic navigation data
const topics = [
	{ title: 'What is a Fork?', slug: '/learn/fork', path: '/learn/fork' },
	{
		title: 'Fork Trigger Mechanics',
		slug: '/learn/fork/trigger',
		path: '/learn/fork/trigger',
	},
	{ title: 'Dispute Process', slug: '/learn/fork/bonds', path: '/learn/fork/bonds' },
	{
		title: 'Risk Calculation',
		slug: '/learn/fork/calculation',
		path: '/learn/fork/calculation',
	},
	{ title: 'What To Do', slug: '/learn/fork/what-to-do', path: '/learn/fork/what-to-do' },
	{
		title: 'Risk Mitigation',
		slug: '/learn/fork/mitigation',
		path: '/learn/fork/mitigation',
	},
]

const currentPath = Astro.url.pathname
---

<!doctype html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width" />
		<link rel="icon" type="image/svg+xml" href="/favicon.svg" />
		<meta name="generator" content={Astro.generator} />
		<title>{title} - Augur Fork Mechanics</title>
		{description && <meta name="description" content={description} />}
	</head>
	<body>
		<div class="min-h-screen bg-background text-foreground">
			{/* Header */}
			<header class="border-b border-primary/20 sticky top-0 z-40 bg-background/95 backdrop-blur-sm">
				<div class="max-w-7xl mx-auto px-4 py-4 flex items-center justify-between">
					<a
						href="/"
						class="text-sm uppercase tracking-widest font-light hover:text-primary transition-colors"
					>
						← Back to Fork Meter
					</a>
					<h1 class="text-lg font-light uppercase tracking-widest">{title}</h1>
					<div></div>
				</div>
			</header>

			<div class="max-w-7xl mx-auto px-4 py-8">
				<div class="grid grid-cols-1 md:grid-cols-4 gap-8">
					{/* Sidebar Navigation */}
					<nav class="md:col-span-1">
						<div class="sticky top-24">
							<p class="text-xs uppercase tracking-widest text-muted-foreground font-light mb-4">
								Topics
							</p>
							<div class="space-y-2">
								{
									topics.map((topic) => (
										<a
											href={topic.path}
											class={`block text-sm font-light uppercase tracking-widest px-3 py-2 rounded transition-colors ${
												currentPath === topic.path
													? 'bg-primary/20 text-primary border border-primary/40'
													: 'text-muted-foreground hover:text-foreground hover:bg-primary/5'
											}`}
										>
											{topic.title}
										</a>
									))
								}
							</div>

							{/* Link back to main fork meter */}
							<div class="mt-6 pt-6 border-t border-primary/20">
								<a
									href="/"
									class="text-xs uppercase tracking-widest text-muted-foreground hover:text-primary transition-colors font-light"
								>
									View Fork Meter →
								</a>
							</div>
						</div>
					</nav>

					{/* Main Content */}
					<main class="md:col-span-3">
						<article class="prose prose-invert max-w-none">
							<slot />
						</article>
					</main>
				</div>
			</div>

			{/* Footer */}
			<footer class="border-t border-primary/20 mt-16 py-8 text-center text-xs uppercase tracking-widest text-muted-foreground font-light">
				<p>Learn more about fork mechanics in the <a
					href="https://docs.google.com/viewer?url=https://github.com/AugurProject/whitepaper/releases/download/v2.0.6/augur-whitepaper-v2.pdf"
					target="_blank"
					rel="noopener noreferrer"
					class="text-primary hover:text-primary/80 transition-colors"
				>Augur Whitepaper</a></p>
			</footer>
		</div>

		<style is:global>
			/* Custom prose styles for dark mode - Tailwind v4 CSS-first approach */
			.prose {
				--tw-prose-headings: var(--color-primary);
				--tw-prose-links: var(--color-primary);
				--tw-prose-body: var(--color-foreground);
				--tw-prose-bold: var(--color-foreground);
				--tw-prose-code: var(--color-green-400);
				--tw-prose-borders: var(--color-primary);
				--tw-prose-bg-hover: var(--color-primary);
			}

			.prose h1 {
				font-size: 2rem;
				font-weight: 300;
				text-transform: uppercase;
				letter-spacing: 0.05em;
				margin-bottom: 1rem;
				color: var(--color-primary);
			}

			.prose h2 {
				font-size: 1.5rem;
				font-weight: 300;
				text-transform: uppercase;
				letter-spacing: 0.05em;
				margin-top: 2rem;
				margin-bottom: 1rem;
				color: var(--color-primary);
			}

			.prose h3 {
				font-size: 1.25rem;
				font-weight: 300;
				text-transform: uppercase;
				letter-spacing: 0.05em;
				margin-top: 1.5rem;
				margin-bottom: 0.75rem;
				color: var(--color-primary);
			}

			.prose p {
				line-height: 1.6;
				margin-bottom: 1rem;
				font-weight: 300;
				color: var(--color-foreground);
			}

			.prose a {
				color: var(--color-primary);
				text-decoration: none;
				transition: color 0.2s;
			}

			.prose a:hover {
				color: var(--color-primary);
				opacity: 0.8;
			}

			.prose code {
				background-color: rgba(42, 231, 168, 0.1);
				padding: 0.25rem 0.5rem;
				border-radius: 0.25rem;
				font-size: 0.875rem;
				font-family: monospace;
				color: var(--color-green-400);
			}

			.prose li {
				margin-bottom: 0.5rem;
				font-size: 1rem;
				font-weight: 300;
				color: var(--color-foreground);
			}

			.prose ul,
			.prose ol {
				margin-bottom: 1rem;
				padding-left: 1.5rem;
			}

			.prose blockquote {
				border-left: 2px solid rgba(42, 231, 168, 0.4);
				padding-left: 1rem;
				font-style: italic;
				color: var(--color-green-800);
				padding-top: 0.5rem;
				padding-bottom: 0.5rem;
			}

			.prose table {
				margin-bottom: 1rem;
				width: 100%;
				border-collapse: collapse;
			}

			.prose table th {
				border-bottom: 1px solid rgba(42, 231, 168, 0.3);
				padding: 0.5rem;
				text-align: left;
				font-weight: 400;
				color: var(--color-primary);
			}

			.prose table td {
				border-bottom: 1px solid rgba(42, 231, 168, 0.15);
				padding: 0.5rem;
				color: var(--color-foreground);
			}
		</style>
	</body>
</html>
